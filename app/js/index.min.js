function init(){createWorld(),createPrimitive(),animation()}window.addEventListener("load",init,!1);var scene,camera,renderer,container,_width,_height,mat,Theme={_darkred:0},start=Date.now();function createWorld(){_width=window.innerWidth+400,_height=window.innerHeight-150,(scene=new THREE.Scene).background=new THREE.Color(Theme._darkred),(camera=new THREE.PerspectiveCamera(50,_width/_height,1,500)).position.z=17.5,(renderer=new THREE.WebGLRenderer({antialias:!0,alpha:!1})).setSize(_width,_height),(container=document.getElementById("container")).appendChild(renderer.domElement),window.addEventListener("resize",onWindowResize,!1)}function onWindowResize(){_width=window.innerWidth,_height=window.innerHeight,renderer.setSize(_width,_height),camera.aspect=_width/_height,camera.updateProjectionMatrix(),console.log("- resize -")}var _primitive,primitiveElement=function(){this.mesh=new THREE.Object3D,mat=new THREE.ShaderMaterial({wireframe:!1,uniforms:{time:{type:"f",value:0},pointscale:{type:"f",value:0},decay:{type:"f",value:0},complex:{type:"f",value:0},waves:{type:"f",value:0},eqcolor:{type:"f",value:0},fragment:{type:"i",value:!0},redhell:{type:"i",value:!0}},vertexShader:document.getElementById("vertexShader").textContent,fragmentShader:document.getElementById("fragmentShader").textContent});var e=new THREE.IcosahedronBufferGeometry(3,7),n=new THREE.Points(e,mat);this.mesh.add(n)};function createPrimitive(){_primitive=new primitiveElement,scene.add(_primitive.mesh)}var options={perlin:{vel:.002,speed:5e-4,perlins:1,decay:.1,complex:.3,waves:20,eqcolor:11,fragment:!0,redhell:!0},spin:{sinVel:0,ampVel:80}};function createGUI(){var e=new dat.GUI,n=e.addFolder("Camera");n.add(camera.position,"z",3,20).name("Zoom").listen(),n.add(options.perlin,"vel",0,.02).name("Velocity").listen();var i=e.addFolder("Math Options");i.add(options.spin,"sinVel",0,.5).name("Sine").listen(),i.add(options.spin,"ampVel",0,90).name("Amplitude").listen();var t=e.addFolder("Setup Perlin Noise");t.add(options.perlin,"perlins",1,5).name("Size").step(1),t.add(options.perlin,"speed",0,5e-4).name("Speed").listen(),t.add(options.perlin,"decay",0,1).name("Decay").listen(),t.add(options.perlin,"waves",0,20).name("Waves").listen(),t.add(options.perlin,"fragment",!0).name("Fragment"),t.add(options.perlin,"complex",.1,1).name("Complex").listen(),t.add(options.perlin,"redhell",!0).name("Electroflow"),t.add(options.perlin,"eqcolor",0,15).name("Hue").listen(),t.open()}function animation(){requestAnimationFrame(animation);var e=.003*Date.now();_primitive.mesh.rotation.y+=options.perlin.vel,_primitive.mesh.rotation.x=Math.sin(e*options.spin.sinVel)*options.spin.ampVel*Math.PI/180,mat.uniforms.time.value=options.perlin.speed*(Date.now()-start),mat.uniforms.pointscale.value=options.perlin.perlins,mat.uniforms.decay.value=options.perlin.decay,mat.uniforms.complex.value=options.perlin.complex,mat.uniforms.waves.value=options.perlin.waves,mat.uniforms.eqcolor.value=options.perlin.eqcolor,mat.uniforms.fragment.value=options.perlin.fragment,mat.uniforms.redhell.value=options.perlin.redhell,camera.lookAt(scene.position),renderer.render(scene,camera)}